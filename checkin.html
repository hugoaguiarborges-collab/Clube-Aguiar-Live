<!-- ... tudo igual até o script ... -->
  <script>
    const firebaseConfig = {
      // ... igual ...
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    let todasAlunas = [];
    let checkinCodeOficial = ""; // agora dinâmico!

    function normalizarCodigo(str){
      return str
        .toLowerCase()
        .normalize('NFD').replace(/[\u0300-\u036f]/g, '')
        .replace(/ç/g,'c')
        .replace(/[^a-z0-9]/g,'');
    }

    async function carregarCodigoTreino(){
      // Supondo coleção 'config', documento 'treino', campo 'codigo'
      const doc = await db.collection("config").doc("treino").get();
      checkinCodeOficial = (doc.exists && doc.data().codigo) ? doc.data().codigo : "";
    }

    function preencherSelect(){
      const select = document.getElementById("checkinSelect");
      select.innerHTML = '<option value="" disabled selected>Selecione seu nome</option>';
      todasAlunas.forEach(a=>{
        select.innerHTML += `<option value="${a.nome}">${a.nome}</option>`;
      });
    }

    async function doCheckin(){
      const nome = document.getElementById("checkinSelect").value;
      const code = document.getElementById("checkinCode").value;
      if(!nome){
        alert("Selecione seu nome.");
        return;
      }
      if(!code){
        alert("Digite o código do treino.");
        return;
      }
      if(normalizarCodigo(code) !== normalizarCodigo(checkinCodeOficial)){
        alert("Código do treino inválido!");
        return;
      }
      // Atualiza Firestore +5 pontos
      const snap = await db.collection("usuarios").where("nome","==",nome).get();
      if(snap.empty){
        alert("Nome não encontrado.");
        return;
      }
      const doc = snap.docs[0];
      const pontosAtuais = doc.data().pontos ?? 0;
      await db.collection("usuarios").doc(doc.id).update({pontos: pontosAtuais+5});
      showCheckinSuccess(nome);
    }

    // ... confetti, showCheckinSuccess, etc. igual ...

    async function carregarNomes(){
      const snap = await db.collection("usuarios").orderBy("nome").get();
      todasAlunas = [];
      snap.forEach(doc => {
        const d = doc.data();
        todasAlunas.push({
          nome: d.nome,
        });
      });
      preencherSelect();
    }

    async function inicializarCheckin(){
      await carregarCodigoTreino();
      await carregarNomes();
    }
    inicializarCheckin();
  </script>
<!-- ... resto igual ... -->
